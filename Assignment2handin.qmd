---
title: "Statistik och dataanalys I, 15 hp "
subtitle: "Inl칛mningsuppgift 2, 1.5 hp"
author: 
- Namn 1
- Namn 2
- Namn 3
date: last-modified
format: 
  html:
    self-contained: true
    code-line-numbers: true
  pdf: default  
  docx: default
toc: true
language: 
  title-block-author-single: " "
toc-title-document: "Inneh친ll"
crossref-fig-title: "Figur"
theme: Superhero
title-block-banner-color: Primary
title-block-published: "Publicerad"
callout-warning-caption: "Varning"
callout-note-caption: "Observera"
callout-tip-caption: "Tips"
editor: visual
---

::: callout-important
## Inl칛mning

Inl칛mningsuppgiften ska l칛mnas in i form av ett html dokument genererat av det h칛r Quarto-dokumentet. 칐ppna upp code chunks under de uppgifter de beh칬vs.

**Kontrollera noga att du inte har n친gra felmeddelande och att dokumentet kompileras utan problem**. Anv칛nd tydliga figurer och namnge axlarna med tydliga variabelnamn. Gl칬m inte att skriva era namn ovanf칬r ist칛llet f칬r Namn 1, Namn 2 och Namn 3.
:::

::: callout-tip
## Matematiska symboler i rapporten

Om en formel ska anges s친 칛r det ok att skriva det i vanlig text (markdown), typ

xbar +- t(0.025,n-1)\*s/sqrt(n),

Vill man vara lite fancy kan man ge sig p친 att skriva matematik med LaTeX genom att anv칛nda dubbla dollar-tecken:

$\bar x \pm t_{0.025,n-1}\frac{s}{\sqrt n}$.

LaTeX 칛r fint, men lite kr친ngligt att l칛ra sig hur man ska skriva.
:::

L칛s in dina paket h칛r:

```{r}
#| echo: false
#| output: false
library(remotes)
install_github("StatisticsSU/sda1paket")
library(sda1)
library(mosaic)
library(gplots) # for the plotLowess function
```

och definiera v친r dataframe `df` med datamaterialet:

```{r}
df = electricitycost
head(df)
```

## 1. Poisson-modell f칬r antal personer i hush친llet

#### 游눩 Uppgift 1.1

Vi skattar lambda genom att ta medelv칛rdet av observerade data, och g칬r en modell av people fr친n en Pois(lambda)-f칬rdelning.

```{r}
extrapeople = df$people - 1
lambda <- mean(extrapeople)
xvalues <- 0:5
pois_probs <- dpois(x = xvalues, lambda)
```

#### 游눩 Uppgift 1.2

Vi ritar stapeldiagram f칬r observerade data, och f칬r poisson-distributionen.

```{r}
names(pois_probs) <- xvalues
observed <- tally(extrapeople, format = "proportion")
par(mfrow = c(1, 2))
barplot(observed, xlab  = "x", ylab = "P(X=x)", main = "Observerade data")
barplot(pois_probs, col = "orange", xlab  = "x", ylab = "P(X=x)", main = "Poisson med lambda = 1.65")
par(mfrow = c(1, 1))
```

Vi ser att diagrammen 칛r lika, och drar slutsatsen att den skattade Poisson-modellen skattar datan v칛l.

#### 游눩 Uppgift 1.3

Vi vill ber칛kna sannolikheten att att hush친ll har fler 칛n 4 personer. I R g칬r vi ber칛kningen:

```{r}
1 - ppois(4, lambda = lambda)
```

Sannolikheten att ett hush친ll har fler 칛n 4 personer 칛r 2.63 procent.

#### 游눩 Uppgift 1.4

Vi vet att variansen och v칛ntev칛rdet f칬r Poisson-f칬rdelningen 칛r 1.65. Variansen och v칛ntev칛rdet f칬r observerade datan f친s fr친n ber칛kningarna:

```{r}
observed_variance <- var(extrapeople)
observed_expected_value <- weighted.mean(extrapeople)
```

vilket ger oss observerad varians = 1.43, och observerat v칛ntev칛rde = 1.646.

Det observerade v칛ntev칛rdet 칛r ungef칛r samma som v칛ntev칛rdet f칬r Poisson-f칬rdelningen. Den observerade variansen skiljer sig dock. Fr친gan 칛r om skillnaden 칛r f칬r stor f칬r att Poisson-f칬rdelningen ska vara en bra modell.

Vi simulerar m친nga stickprovsvarianser fr친n poissonf칬rdelningen och j칛mf칬r med den observerade variansen.

```{r}
nsim <- 10000
n <- length(extrapeople)
simulated_variance <- rep(0, nsim)
count <- 0
for (i in 1:nsim) {
  count <- count + 1
  x <- rpois(n = n, lambda = lambda)
  simulated_variance[count] <- var(x)
}
hist(simulated_variance, 30, freq = FALSE)
x_grid <- seq(min(simulated_variance), max(simulated_variance), length = 40)
standard_deviation <- sd(simulated_variance)
normal_curve <- dnorm(x_grid, mean = mean(simulated_variance), sd = sd(simulated_variance))
lines(x_grid, normal_curve, col = 2, lwd = 2)
```

I diagrammet kan vi avl칛sa att variansen hos observerade datan (1.42) skulle vara mycket ovanlig om den observerade datan verkligen f칬ljde en Poisson-distribution. Kanske 칛r det d칛rf칬r ol칛mpligt att anv칛nda poisson-f칬rdelning f칬r att modellera people.

## 2. (log)-normalmodell f칬r elkostnad

#### 游눩 Uppgift 2.1

#### 游눩 Uppgift 2.2

#### 游눩 Uppgift 2.3

#### 游눩 Uppgift 2.4

#### 游눩 Uppgift 2.5

#### 游눩 Uppgift 2.6

#### 游눩 Uppgift 2.7

#### 游눩 Uppgift 2.8

## 3. Enkel och multipel linj칛r regression

#### 游눩 Uppgift 3.1

#### 游눩 Uppgift 3.2

#### 游눩 Uppgift 3.3

#### 游눩 Uppgift 3.4

#### 游눩 Uppgift 3.5

#### 游눩 Uppgift 3.6

#### 游눩 Uppgift 3.7
